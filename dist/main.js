(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add("popup__opened")}function n(e){e.classList.remove("popup__opened"),document.removeEventListener("keydown",o)}function o(e){"Escape"===e.key&&n(document.querySelector(".popup__opened"))}e.d({},{R:()=>b});var r={baseUrl:"https://nomoreparties.co/v1/plus-cohort-18",headers:{authorization:"abe1d7ae-ecc9-47d5-a35f-74536599426e","Content-Type":"application/json"}};function c(e){return e.ok?e.json():Promise.reject(e.status)}function u(){return fetch("".concat(r.baseUrl,"/cards"),{method:"GET",headers:r.headers}).then((function(e){return c(e)}))}function a(e,t){t?e.textContent="Сохранение...":e.id?e.textContent="Создать":e.textContent="Сохранить"}function i(e,t,n,o){t.textContent=o.name,n.textContent=o.about,e.src=o.avatar}var l=document.querySelector(".profile__avatar"),s=document.querySelector(".popup_card-add"),d=document.querySelector(".popup_image-zoom"),p=document.querySelector("#card-template").content,f=document.querySelector(".popup__caption"),m=document.querySelector("#popupProfileAddButton"),_=s.querySelector(".popup__form-field[name=placeName-input]"),v=s.querySelector(".popup__form-field[name=placeUrl-input]");function h(e,t){return 1===t.filter((function(t){return t._id==e})).length}function y(e,n,o,u,a,i){var s=p.querySelector(".element").cloneNode(!0),m=s.querySelector(".element__like-button"),_=s.querySelector(".element__like-counter");_.textContent=a.length,h(u,a)&&m.classList.add("element__like-button_active"),m.addEventListener("click",(function(e){h(u,a)?function(e){return fetch("".concat(r.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:r.headers}).then((function(e){return c(e)}))}(i).then((function(t){_.textContent=t.likes.length,e.target.classList.toggle("element__like-button_active"),a=t.likes})).catch((function(e){console.log("Что-то пошло не так. Ошбика: ".concat(e))})):function(e){return fetch("".concat(r.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:r.headers}).then((function(e){return c(e)}))}(i).then((function(t){_.textContent=t.likes.length,e.target.classList.toggle("element__like-button_active"),a=t.likes})).catch((function(e){console.log("Что-то пошло не так. Ошбика: ".concat(e))}))}));var v=s.querySelector(".element__delete-button");u==o?v.addEventListener("click",(function(){var e=v.closest(".element");(function(e){return fetch("".concat(r.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:r.headers}).then((function(e){return c(e)}))})(i).then((function(){return e.remove()})).catch((function(e){console.log("Что-то пошло не так. Ошбика: ".concat(e))}))})):v.remove();var y=s.querySelector(".element__image");return y.addEventListener("click",(function(){t(d),l.src=n,l.alt="Фото ".concat(e),f.textContent=e})),s.querySelector(".element__info").textContent=e,y.src=n,y.setAttribute("alt","Фото ".concat(e)),s}m.addEventListener("submit",(function(e){var t,o;e.preventDefault(),a(e.submitter,!0),(t=_.value,o=v.value,fetch("".concat(r.baseUrl,"/cards"),{method:"POST",headers:r.headers,body:JSON.stringify({name:"".concat(t),link:"".concat(o)})}).then((function(e){return c(e)}))).then((function(e){b.prepend(y(e.name,e.link,e.owner._id,e.owner._id,e.likes,e._id)),n(s),m.reset()})).catch((function(e){console.log("Что-то пошло не так. Ошбика: ".concat(e))})).finally((function(){setTimeout((function(){a(e.submitter,!1)}),300)}))}));var S,b=document.querySelector(".elements"),q=document.querySelector(".profile"),g=q.querySelector(".profile__edit-button"),E=document.querySelector(".popup_profile-edit"),L=document.querySelector("#avatar-change"),k=document.querySelector(".popup_form_layout"),C=Array.from(document.querySelectorAll(".popup")),A=q.querySelector(".profile__add-button"),x=(document.querySelector("#popupProfileEditForm"),document.querySelector("#profile__name-input")),T=document.querySelector("#profile__description-input"),U=document.querySelector("#profile__name"),P=document.querySelector("#profile__description"),w=(document.querySelector("#placeName-input"),document.querySelector("#placeUrl-input"),document.querySelector(".profile__avatar-change-button")),O=(document.querySelector(".profile__avatar"),document.querySelector("#avatar-change")),B=k.querySelector(".popup__form-field[name=placeAvatar-change-input]"),D=(document.querySelector("#addCardSubmitBtn"),document.querySelectorAll(".popup__close-button"));fetch("".concat(r.baseUrl,"/users/me"),{method:"GET",headers:r.headers}).then((function(e){return c(e)})).then((function(e){i(l,U,P,e);var t=e._id;u().then((function(e){!function(e,t,n){var o=new Set;t.forEach((function(t){o.has(t._id)||(o.add(t._id),e.prepend(y(t.name,t.link,t.owner._id,n,t.likes,t._id)))}))}(b,e,t)})).catch((function(e){console.log("Что-то пошло не так. Ошбика: ".concat(e))}))})),D.forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return n(t)}))})),document.addEventListener("keyup",o),g.addEventListener("click",(function(){t(E)})),C.forEach((function(e){addEventListener("mousedown",(function(t){t.target.classList.contains("popup__opened")&&n(e),t.target.classList.contains("popup__close-button")&&n(e)}))})),g.addEventListener("click",(function(){t(E),x.value=U.innerText,T.value=P.innerText})),popupProfileEditForm.addEventListener("submit",(function(e){var t,o;e.preventDefault(),a(e.submitter,!0),(t=x.value,o=T.value,fetch("".concat(r.baseUrl,"/users/me"),{method:"PATCH",headers:r.headers,body:JSON.stringify({name:"".concat(t),about:"".concat(o)})}).then((function(e){return c(e)}))).then((function(e){i(l,U,P,e),n(E)})).catch((function(e){console.log("Что-то пошло не так. Ошбика: ".concat(e))})).finally((function(){setTimeout((function(){a(e.submitter,!1)}),300)}))})),A.addEventListener("click",(function(){t(s)})),w.addEventListener("click",(function(){t(L)})),O.addEventListener("submit",(function(e){var t;e.preventDefault(),a(e.submitter,!0),(t=B.value,fetch("".concat(r.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:r.headers,body:JSON.stringify({avatar:"".concat(t)})}).then((function(e){return c(e)}))).then((function(t){i(l,U,P,t),n(L),e.target.reset()})).catch((function(e){console.log("Что-то пошло не так. Ошбика: ".concat(e))})).finally((function(){setTimeout((function(){a(e.submitter,!1)}),300)}))})),S={formSelector:".popup__form",inputSelector:".popup__form-field",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_notActive",inputErrorClass:"popup__eror-masage",errorClass:"popup__eror-masage_active"},document.querySelectorAll(S.formSelector).forEach((function(e){e.setAttribute("novalidate",!0),function(e,t,n){Array.from(e.querySelectorAll(".popup__form-field")).forEach((function(o){o.addEventListener("input",(function(){(function(e,t,n){var o,r=e.querySelector(t);o=e.querySelectorAll(".popup__form-field"),Array.prototype.some.call(o,(function(e){return!1===e.validity.valid}))?(r.classList.add(n),r.setAttribute("disabled",!0)):(r.classList.remove(n),r.removeAttribute("disabled"))})(e,t,n),function(e,t){t.validity.valid?function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));n.classList.remove("popup__eror-masage"),n.textContent="",n.classList.remove("popup__eror-masage_active"),t.classList.remove("popup__form-field_type_error")}(e,t):function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));o.classList.add("popup__eror-masage"),""===t.value?o.textContent="Вы пропустили это поле":o.textContent=n,o.classList.add("popup__eror-masage_active")}(e,t,t.validationMessage)}(e,o)}))})),e.addEventListener("submit",(function(e){e.preventDefault()}))}(e,S.submitButtonSelector,S.inactiveButtonClass)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SCxFQUFLbkUsaUJBQWlCLFVBQVUsU0FBQ2tGLEdBQy9CQSxFQUFNaEUsZ0JBQ1IsR0FDRixDQVNJaUUsQ0FDRWhCLEVBQ0F2QyxFQUEwQm1DLHFCQUMxQm5DLEVBQTBCb0Msb0JBRTlCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly95YW5kZXgucHJha3Rpa3VtL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3lhbmRleC5wcmFrdGlrdW0vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3lhbmRleC5wcmFrdGlrdW0vd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly95YW5kZXgucHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvbW9kYWwuanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWt0aWt1bS8uL3NyYy9jb21wb25lbnRzL2FwaS5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWt0aWt1bS8uL3NyYy9jb21wb25lbnRzL2NhcmQuanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWt0aWt1bS8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvdmFsaWRhdGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJleHBvcnQgZnVuY3Rpb24gb3BlblBvcHVwKGNsaWNrZWRQb3B1cCkge1xuICBjbGlja2VkUG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX19vcGVuZWRcIik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZVBvcHVwKGNsaWNrZWRQb3B1cCkge1xuICBjbGlja2VkUG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX19vcGVuZWRcIik7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGVzY0hhbmRsZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXNjSGFuZGxlcihldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBvcGVuZWRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX29wZW5lZFwiKTtcbiAgICBjbG9zZVBvcHVwKG9wZW5lZFBvcHVwKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGRhdGEgPSB7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3BsdXMtY29ob3J0LTE4XCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImFiZTFkN2FlLWVjYzktNDdkNS1hMzVmLTc0NTM2NTk5NDI2ZVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufTtcblxuZnVuY3Rpb24gZ2V0UmVzRGF0YShyZXMpIHtcbiAgaWYgKHJlcy5vaykge1xuICAgIHJldHVybiByZXMuanNvbigpO1xuICB9XG4gIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEluaXRpYWxDYXJkcygpIHtcbiAgcmV0dXJuIGZldGNoKGAke2RhdGEuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIGhlYWRlcnM6IGRhdGEuaGVhZGVycyxcbiAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgcmV0dXJuIGdldFJlc0RhdGEocmVzKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VySW5mb3JtYXRpb24oKSB7XG4gIHJldHVybiBmZXRjaChgJHtkYXRhLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBoZWFkZXJzOiBkYXRhLmhlYWRlcnMsXG4gIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgIHJldHVybiBnZXRSZXNEYXRhKHJlcyk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZWRpdFByb2ZpbGVJbmZvKG5hbWUsIGFib3V0KSB7XG4gIHJldHVybiBmZXRjaChgJHtkYXRhLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgIGhlYWRlcnM6IGRhdGEuaGVhZGVycyxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBuYW1lOiBgJHtuYW1lfWAsXG4gICAgICBhYm91dDogYCR7YWJvdXR9YCxcbiAgICB9KSxcbiAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgcmV0dXJuIGdldFJlc0RhdGEocmVzKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3N0TmV3Q2FyZChuYW1lLCBsaW5rKSB7XG4gIHJldHVybiBmZXRjaChgJHtkYXRhLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgaGVhZGVyczogZGF0YS5oZWFkZXJzLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIG5hbWU6IGAke25hbWV9YCxcbiAgICAgIGxpbms6IGAke2xpbmt9YCxcbiAgICB9KSxcbiAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgcmV0dXJuIGdldFJlc0RhdGEocmVzKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVDYXJkKGNhcmRJZCkge1xuICByZXR1cm4gZmV0Y2goYCR7ZGF0YS5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIGhlYWRlcnM6IGRhdGEuaGVhZGVycyxcbiAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgcmV0dXJuIGdldFJlc0RhdGEocmVzKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3N0QXZhdGFyKGF2YXRhckxpbmspIHtcbiAgcmV0dXJuIGZldGNoKGAke2RhdGEuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgIGhlYWRlcnM6IGRhdGEuaGVhZGVycyxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBhdmF0YXI6IGAke2F2YXRhckxpbmt9YCxcbiAgICB9KSxcbiAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgcmV0dXJuIGdldFJlc0RhdGEocmVzKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdXRMaWtlKGNhcmRJZCkge1xuICByZXR1cm4gZmV0Y2goYCR7ZGF0YS5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgIGhlYWRlcnM6IGRhdGEuaGVhZGVycyxcbiAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgcmV0dXJuIGdldFJlc0RhdGEocmVzKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVMaWtlKGNhcmRJZCkge1xuICByZXR1cm4gZmV0Y2goYCR7ZGF0YS5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIGhlYWRlcnM6IGRhdGEuaGVhZGVycyxcbiAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgcmV0dXJuIGdldFJlc0RhdGEocmVzKTtcbiAgfSk7XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gc3dpdGNoTG9hZGluZ01lc2coRGVzdGluYXRpb24sIExvYWRpbmcpIHtcbiAgaWYgKExvYWRpbmcpIHtcbiAgICBEZXN0aW5hdGlvbi50ZXh0Q29udGVudCA9IFwi0KHQvtGF0YDQsNC90LXQvdC40LUuLi5cIjtcbiAgfSBlbHNlIHtcbiAgICBpZiAoRGVzdGluYXRpb24uaWQpIHtcbiAgICAgIERlc3RpbmF0aW9uLnRleHRDb250ZW50ID0gXCLQodC+0LfQtNCw0YLRjFwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBEZXN0aW5hdGlvbi50ZXh0Q29udGVudCA9IFwi0KHQvtGF0YDQsNC90LjRgtGMXCI7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVVc2VySW5mb3JtYXRpb24oYXZhdGFyLCBuYW1lLCBhYm91dCwganNvbikge1xuICBuYW1lLnRleHRDb250ZW50ID0ganNvbltcIm5hbWVcIl07XG4gIGFib3V0LnRleHRDb250ZW50ID0ganNvbltcImFib3V0XCJdO1xuICBhdmF0YXIuc3JjID0ganNvbltcImF2YXRhclwiXTtcbn1cbiIsIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgeyBvcGVuUG9wdXAsIGNsb3NlUG9wdXAgfSBmcm9tIFwiLi9tb2RhbC5qc1wiO1xuaW1wb3J0IHsgZGVsZXRlQ2FyZCwgcHV0TGlrZSwgZGVsZXRlTGlrZSwgcG9zdE5ld0NhcmQgfSBmcm9tIFwiLi9hcGkuanNcIjtcbmltcG9ydCB7IHN3aXRjaExvYWRpbmdNZXNnIH0gZnJvbSBcIi4vdXRpbHMuanNcIjtcbmltcG9ydCB7IGVsZW1lbnRzIH0gZnJvbSBcIi4vLi4vaW5kZXguanNcIjtcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG5leHBvcnQgY29uc3QgcG9wdXBBZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX2NhcmQtYWRkXCIpO1xuY29uc3QgcG9wdXBab29tID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9pbWFnZS16b29tXCIpO1xuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQ7XG5jb25zdCBwb3B1cENhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpO1xuY29uc3QgZm9ybUVsZW1lbnRBZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwUHJvZmlsZUFkZEJ1dHRvblwiKTtcbmNvbnN0IGRlc2NyaXB0aW9uQWRkRm9ybSA9IHBvcHVwQWRkLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnBvcHVwX19mb3JtLWZpZWxkW25hbWU9cGxhY2VOYW1lLWlucHV0XVwiXG4pO1xuY29uc3QgbGlua0FkZEZvcm0gPSBwb3B1cEFkZC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wb3B1cF9fZm9ybS1maWVsZFtuYW1lPXBsYWNlVXJsLWlucHV0XVwiXG4pO1xuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckluaXRpYWxDYXJkcyhjb250YWluZXIsIGpzb24sIG15SWQpIHtcbiAgY29uc3Qgc2VlbklkcyA9IG5ldyBTZXQoKTtcbiAganNvbi5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgaWYgKCFzZWVuSWRzLmhhcyhjYXJkW1wiX2lkXCJdKSkge1xuICAgICAgc2Vlbklkcy5hZGQoY2FyZFtcIl9pZFwiXSk7XG4gICAgICBjb250YWluZXIucHJlcGVuZChcbiAgICAgICAgYWRkQ2FyZChcbiAgICAgICAgICBjYXJkLm5hbWUsXG4gICAgICAgICAgY2FyZC5saW5rLFxuICAgICAgICAgIGNhcmRbXCJvd25lclwiXVtcIl9pZFwiXSxcbiAgICAgICAgICBteUlkLFxuICAgICAgICAgIGNhcmRbXCJsaWtlc1wiXSxcbiAgICAgICAgICBjYXJkW1wiX2lkXCJdXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gaGFzTXlMaWtlKG15SWQsIGxpa2VzKSB7XG4gIGNvbnN0IG1hdGNoaW5nTGlrZXMgPSBsaWtlcy5maWx0ZXIoKG9iaikgPT4ge1xuICAgIHJldHVybiBvYmpbXCJfaWRcIl0gPT0gbXlJZDtcbiAgfSk7XG4gIHJldHVybiBtYXRjaGluZ0xpa2VzLmxlbmd0aCA9PT0gMTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZENhcmQobmFtZSwgbGluaywgT1dORVJJRCwgbXlJZCwgbGlrZXMsIGNhcmRJZCkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIikuY2xvbmVOb2RlKHRydWUpO1xuICBjb25zdCBsaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlLWJ1dHRvblwiKTtcbiAgY29uc3QgbGlrZXNDb3VudGVyID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlLWNvdW50ZXJcIik7XG4gIGxpa2VzQ291bnRlci50ZXh0Q29udGVudCA9IGxpa2VzLmxlbmd0aDtcbiAgaWYgKGhhc015TGlrZShteUlkLCBsaWtlcykpIHtcbiAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50X19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH1cbiAgbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgIGlmIChoYXNNeUxpa2UobXlJZCwgbGlrZXMpKSB7XG4gICAgICBkZWxldGVMaWtlKGNhcmRJZClcbiAgICAgICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XG4gICAgICAgICAgbGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdXBkYXRlZENhcmRbXCJsaWtlc1wiXS5sZW5ndGg7XG4gICAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgICAgICAgIGxpa2VzID0gdXBkYXRlZENhcmRbXCJsaWtlc1wiXTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGDQp9GC0L4t0YLQviDQv9C+0YjQu9C+INC90LUg0YLQsNC6LiDQntGI0LHQuNC60LA6ICR7ZXJyb3J9YCk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBwdXRMaWtlKGNhcmRJZClcbiAgICAgICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XG4gICAgICAgICAgbGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdXBkYXRlZENhcmRbXCJsaWtlc1wiXS5sZW5ndGg7XG4gICAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgICAgICAgIGxpa2VzID0gdXBkYXRlZENhcmRbXCJsaWtlc1wiXTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGDQp9GC0L4t0YLQviDQv9C+0YjQu9C+INC90LUg0YLQsNC6LiDQntGI0LHQuNC60LA6ICR7ZXJyb3J9YCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3QgZGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19kZWxldGUtYnV0dG9uXCIpO1xuICBpZiAobXlJZCA9PSBPV05FUklEKSB7XG4gICAgZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBuZXdDYXJkID0gZGVsZXRlQnRuLmNsb3Nlc3QoXCIuZWxlbWVudFwiKTtcbiAgICAgIGRlbGV0ZUNhcmQoY2FyZElkKVxuICAgICAgICAudGhlbigoKSA9PiBuZXdDYXJkLnJlbW92ZSgpKVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGDQp9GC0L4t0YLQviDQv9C+0YjQu9C+INC90LUg0YLQsNC6LiDQntGI0LHQuNC60LA6ICR7ZXJyfWApO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBkZWxldGVCdG4ucmVtb3ZlKCk7XG4gIH1cblxuICBjb25zdCBpbWFnZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faW1hZ2VcIik7XG4gIGltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgb3BlblBvcHVwKHBvcHVwWm9vbSk7XG4gICAgcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xuICAgIHBvcHVwSW1hZ2UuYWx0ID0gYNCk0L7RgtC+ICR7bmFtZX1gO1xuICAgIHBvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gIH0pO1xuXG4gIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faW5mb1wiKS50ZXh0Q29udGVudCA9IG5hbWU7XG4gIGltYWdlLnNyYyA9IGxpbms7XG4gIGltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBg0KTQvtGC0L4gJHtuYW1lfWApO1xuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5mb3JtRWxlbWVudEFkZC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIHN3aXRjaExvYWRpbmdNZXNnKGV2dC5zdWJtaXR0ZXIsIHRydWUpO1xuICBwb3N0TmV3Q2FyZChkZXNjcmlwdGlvbkFkZEZvcm0udmFsdWUsIGxpbmtBZGRGb3JtLnZhbHVlKVxuICAgIC50aGVuKChqc29uKSA9PiB7XG4gICAgICBlbGVtZW50cy5wcmVwZW5kKFxuICAgICAgICBhZGRDYXJkKFxuICAgICAgICAgIGpzb25bXCJuYW1lXCJdLFxuICAgICAgICAgIGpzb25bXCJsaW5rXCJdLFxuICAgICAgICAgIGpzb25bXCJvd25lclwiXVtcIl9pZFwiXSxcbiAgICAgICAgICBqc29uW1wib3duZXJcIl1bXCJfaWRcIl0sXG4gICAgICAgICAganNvbltcImxpa2VzXCJdLFxuICAgICAgICAgIGpzb25bXCJfaWRcIl1cbiAgICAgICAgKVxuICAgICAgKTtcbiAgICAgIGNsb3NlUG9wdXAocG9wdXBBZGQpO1xuICAgICAgZm9ybUVsZW1lbnRBZGQucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhg0KfRgtC+LdGC0L4g0L/QvtGI0LvQviDQvdC1INGC0LDQui4g0J7RiNCx0LjQutCwOiAke2Vycn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBzd2l0Y2hMb2FkaW5nTWVzZyhldnQuc3VibWl0dGVyLCBmYWxzZSk7XG4gICAgICB9LCAzMDApO1xuICAgIH0pO1xufSk7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCB7IG9wZW5Qb3B1cCwgY2xvc2VQb3B1cCwgZXNjSGFuZGxlciB9IGZyb20gXCIuL2NvbXBvbmVudHMvbW9kYWwuanNcIjtcbmltcG9ydCB7XG4gIGdldEluaXRpYWxDYXJkcyxcbiAgZ2V0VXNlckluZm9ybWF0aW9uLFxuICBlZGl0UHJvZmlsZUluZm8sXG4gIHBvc3RBdmF0YXIsXG59IGZyb20gXCIuL2NvbXBvbmVudHMvYXBpLmpzXCI7XG5pbXBvcnQge1xuICB1cGRhdGVVc2VySW5mb3JtYXRpb24sXG4gIHN3aXRjaExvYWRpbmdNZXNnLFxufSBmcm9tIFwiLi9jb21wb25lbnRzL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyByZW5kZXJJbml0aWFsQ2FyZHMsIHBvcHVwSW1hZ2UsIHBvcHVwQWRkIH0gZnJvbSBcIi4vY29tcG9uZW50cy9jYXJkLmpzXCI7XG5pbXBvcnQgeyBlbmFibGVWYWxpZGF0aW9uIH0gZnJvbSBcIi4vY29tcG9uZW50cy92YWxpZGF0ZS5qc1wiO1xuZXhwb3J0IGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c1wiKTtcbmNvbnN0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVcIik7XG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IHBvcHVwRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfcHJvZmlsZS1lZGl0XCIpO1xuY29uc3QgcG9wdXBDaGFuZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1jaGFuZ2VcIik7XG5jb25zdCBwb3B1cENoYW5nZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX2Zvcm1fbGF5b3V0XCIpO1xuY29uc3QgYWxsUG9wdXAgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBcIikpO1xuY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgZm9ybUVsZW1lbnRFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cFByb2ZpbGVFZGl0Rm9ybVwiKTtcbmNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX19kZXNjcmlwdGlvbi1pbnB1dFwiKTtcbmNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IGlucHV0RGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcGxhY2VOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYWNlTmFtZS1pbnB1dFwiKTtcbmNvbnN0IHBsYWNlVXJsSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYWNlVXJsLWlucHV0XCIpO1xuY29uc3QgYXZhdGFyQ2hhbmdlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWNoYW5nZS1idXR0b25cIlxuKTtcbmNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG5jb25zdCBwb3B1cEF2YXRhckNoYW5nZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWNoYW5nZVwiKTtcbmNvbnN0IGF2YXRhckNoYW5nZUlucHV0ID0gcG9wdXBDaGFuZ2VGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnBvcHVwX19mb3JtLWZpZWxkW25hbWU9cGxhY2VBdmF0YXItY2hhbmdlLWlucHV0XVwiXG4pO1xuXG5jb25zdCBhZGRDYXJkU3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGRDYXJkU3VibWl0QnRuXCIpO1xuY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpO1xuXG5nZXRVc2VySW5mb3JtYXRpb24oKS50aGVuKChkYXRhKSA9PiB7XG4gIHVwZGF0ZVVzZXJJbmZvcm1hdGlvbihwb3B1cEltYWdlLCBpbnB1dE5hbWUsIGlucHV0RGVzY3JpcHRpb24sIGRhdGEpO1xuICBjb25zdCBteUlkID0gZGF0YVtcIl9pZFwiXTtcbiAgZ2V0SW5pdGlhbENhcmRzKClcbiAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgcmVuZGVySW5pdGlhbENhcmRzKGVsZW1lbnRzLCBqc29uLCBteUlkKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhg0KfRgtC+LdGC0L4g0L/QvtGI0LvQviDQvdC1INGC0LDQui4g0J7RiNCx0LjQutCwOiAke2Vycn1gKTtcbiAgICB9KTtcbn0pO1xuY2xvc2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICBjb25zdCBwb3B1cCA9IGJ1dHRvbi5jbG9zZXN0KFwiLnBvcHVwXCIpO1xuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlUG9wdXAocG9wdXApKTtcbn0pO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgZXNjSGFuZGxlcik7XG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBvcGVuUG9wdXAocG9wdXBFZGl0KTtcbn0pO1xuYWxsUG9wdXAuZm9yRWFjaCgocG9wdXApID0+IHtcbiAgYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX29wZW5lZFwiKSkge1xuICAgICAgY2xvc2VQb3B1cChwb3B1cCk7XG4gICAgfVxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZS1idXR0b25cIikpIHtcbiAgICAgIGNsb3NlUG9wdXAocG9wdXApO1xuICAgIH1cbiAgfSk7XG59KTtcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIG9wZW5Qb3B1cChwb3B1cEVkaXQpO1xuICBuYW1lSW5wdXQudmFsdWUgPSBpbnB1dE5hbWUuaW5uZXJUZXh0O1xuICBqb2JJbnB1dC52YWx1ZSA9IGlucHV0RGVzY3JpcHRpb24uaW5uZXJUZXh0O1xufSk7XG5wb3B1cFByb2ZpbGVFZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIHN3aXRjaExvYWRpbmdNZXNnKGV2dC5zdWJtaXR0ZXIsIHRydWUpO1xuICBlZGl0UHJvZmlsZUluZm8obmFtZUlucHV0LnZhbHVlLCBqb2JJbnB1dC52YWx1ZSlcbiAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgdXBkYXRlVXNlckluZm9ybWF0aW9uKHBvcHVwSW1hZ2UsIGlucHV0TmFtZSwgaW5wdXREZXNjcmlwdGlvbiwganNvbik7XG4gICAgICBjbG9zZVBvcHVwKHBvcHVwRWRpdCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coYNCn0YLQvi3RgtC+INC/0L7RiNC70L4g0L3QtSDRgtCw0LouINCe0YjQsdC40LrQsDogJHtlcnJ9YCk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgc3dpdGNoTG9hZGluZ01lc2coZXZ0LnN1Ym1pdHRlciwgZmFsc2UpO1xuICAgICAgfSwgMzAwKTtcbiAgICB9KTtcbn0pO1xucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBvcGVuUG9wdXAocG9wdXBBZGQpO1xufSk7XG5hdmF0YXJDaGFuZ2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgb3BlblBvcHVwKHBvcHVwQ2hhbmdlKTtcbn0pO1xucG9wdXBBdmF0YXJDaGFuZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBzd2l0Y2hMb2FkaW5nTWVzZyhldnQuc3VibWl0dGVyLCB0cnVlKTtcbiAgcG9zdEF2YXRhcihhdmF0YXJDaGFuZ2VJbnB1dC52YWx1ZSlcbiAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgdXBkYXRlVXNlckluZm9ybWF0aW9uKHBvcHVwSW1hZ2UsIGlucHV0TmFtZSwgaW5wdXREZXNjcmlwdGlvbiwganNvbik7XG4gICAgICBjbG9zZVBvcHVwKHBvcHVwQ2hhbmdlKTtcbiAgICAgIGV2dC50YXJnZXQucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhg0KfRgtC+LdGC0L4g0L/QvtGI0LvQviDQvdC1INGC0LDQui4g0J7RiNCx0LjQutCwOiAke2Vycn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBzd2l0Y2hMb2FkaW5nTWVzZyhldnQuc3VibWl0dGVyLCBmYWxzZSk7XG4gICAgICB9LCAzMDApO1xuICAgIH0pO1xufSk7XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb25Db25zdGFudHMgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2Zvcm0tZmllbGRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uX25vdEFjdGl2ZVwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2Vyb3ItbWFzYWdlXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vyb3ItbWFzYWdlX2FjdGl2ZVwiLFxufTtcbmVuYWJsZVZhbGlkYXRpb24oZW5hYmxlVmFsaWRhdGlvbkNvbnN0YW50cyk7XG4iLCJmdW5jdGlvbiBzaG93SW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgZXJyb3JNZXNzYWdlKSB7XG4gIGNvbnN0IGVycm9yID0gZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgZXJyb3IuY2xhc3NMaXN0LmFkZChcInBvcHVwX19lcm9yLW1hc2FnZVwiKTtcbiAgaWYgKGlucHV0LnZhbHVlID09PSBcIlwiKSB7XG4gICAgZXJyb3IudGV4dENvbnRlbnQgPSBcItCS0Ysg0L/RgNC+0L/Rg9GB0YLQuNC70Lgg0Y3RgtC+INC/0L7Qu9C1XCI7XG4gIH0gZWxzZSB7XG4gICAgZXJyb3IudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIH1cbiAgZXJyb3IuY2xhc3NMaXN0LmFkZChcInBvcHVwX19lcm9yLW1hc2FnZV9hY3RpdmVcIik7XG59XG5cbmZ1bmN0aW9uIGhpZGVJbnB1dEVycm9yKGZvcm0sIGlucHV0KSB7XG4gIGNvbnN0IGVycm9yID0gZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgZXJyb3IuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX19lcm9yLW1hc2FnZVwiKTtcbiAgZXJyb3IudGV4dENvbnRlbnQgPSBcIlwiO1xuICBlcnJvci5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfX2Vyb3ItbWFzYWdlX2FjdGl2ZVwiKTtcbiAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX19mb3JtLWZpZWxkX3R5cGVfZXJyb3JcIik7XG59XG5cbmZ1bmN0aW9uIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtLCBpbnB1dCkge1xuICBpZiAoIWlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybSwgaW5wdXQsIGlucHV0LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtLCBpbnB1dCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFzSW52YWxpZElucHV0KGlucHV0cykge1xuICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNvbWUuY2FsbChpbnB1dHMsIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIHJldHVybiBpbnB1dC52YWxpZGl0eS52YWxpZCA9PT0gZmFsc2U7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB0b2dnbGVTdWJtaXRCdXR0b25TdGF0ZShmb3JtLCBidXR0b25TZWxlY3RvciwgaW5hY3RpdmVDbGFzcykge1xuICBjb25zdCBidXR0b24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoYnV0dG9uU2VsZWN0b3IpO1xuICBpZiAoaGFzSW52YWxpZElucHV0KGZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fZm9ybS1maWVsZFwiKSkpIHtcbiAgICBidXR0b24uY2xhc3NMaXN0LmFkZChpbmFjdGl2ZUNsYXNzKTtcbiAgICBidXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVDbGFzcyk7XG4gICAgYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHNldEV2ZW50TGlzdGVuZXJzKGZvcm0sIGJ1dHRvblNlbGVjdG9yLCBpbmFjdGl2ZUNsYXNzKSB7XG4gIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20oZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19mb3JtLWZpZWxkXCIpKTtcblxuICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgdG9nZ2xlU3VibWl0QnV0dG9uU3RhdGUoZm9ybSwgYnV0dG9uU2VsZWN0b3IsIGluYWN0aXZlQ2xhc3MpO1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm0sIGlucHV0KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbihlbmFibGVWYWxpZGF0aW9uQ29uc3RhbnRzKSB7XG4gIGNvbnN0IGZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgICBlbmFibGVWYWxpZGF0aW9uQ29uc3RhbnRzLmZvcm1TZWxlY3RvclxuICApO1xuXG4gIGZvcm1zLmZvckVhY2goKGZvcm0pID0+IHtcbiAgICBmb3JtLnNldEF0dHJpYnV0ZShcIm5vdmFsaWRhdGVcIiwgdHJ1ZSk7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoXG4gICAgICBmb3JtLFxuICAgICAgZW5hYmxlVmFsaWRhdGlvbkNvbnN0YW50cy5zdWJtaXRCdXR0b25TZWxlY3RvcixcbiAgICAgIGVuYWJsZVZhbGlkYXRpb25Db25zdGFudHMuaW5hY3RpdmVCdXR0b25DbGFzc1xuICAgICk7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwib3BlblBvcHVwIiwiY2xpY2tlZFBvcHVwIiwiY2xhc3NMaXN0IiwiYWRkIiwiY2xvc2VQb3B1cCIsInJlbW92ZSIsImRvY3VtZW50IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImVzY0hhbmRsZXIiLCJldnQiLCJxdWVyeVNlbGVjdG9yIiwiZGF0YSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImdldFJlc0RhdGEiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwic3dpdGNoTG9hZGluZ01lc2ciLCJEZXN0aW5hdGlvbiIsIkxvYWRpbmciLCJ0ZXh0Q29udGVudCIsImlkIiwidXBkYXRlVXNlckluZm9ybWF0aW9uIiwiYXZhdGFyIiwibmFtZSIsImFib3V0Iiwic3JjIiwicG9wdXBJbWFnZSIsInBvcHVwQWRkIiwicG9wdXBab29tIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsInBvcHVwQ2FwdGlvbiIsImZvcm1FbGVtZW50QWRkIiwiZGVzY3JpcHRpb25BZGRGb3JtIiwibGlua0FkZEZvcm0iLCJoYXNNeUxpa2UiLCJteUlkIiwibGlrZXMiLCJmaWx0ZXIiLCJsZW5ndGgiLCJhZGRDYXJkIiwibGluayIsIk9XTkVSSUQiLCJjYXJkSWQiLCJjYXJkRWxlbWVudCIsImNsb25lTm9kZSIsImxpa2VCdXR0b24iLCJsaWtlc0NvdW50ZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiZGVsZXRlTGlrZSIsInVwZGF0ZWRDYXJkIiwidGFyZ2V0IiwidG9nZ2xlIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJwdXRMaWtlIiwiZGVsZXRlQnRuIiwibmV3Q2FyZCIsImNsb3Nlc3QiLCJkZWxldGVDYXJkIiwiZXJyIiwiaW1hZ2UiLCJhbHQiLCJzZXRBdHRyaWJ1dGUiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdHRlciIsInZhbHVlIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlbGVtZW50cyIsInJlc2V0IiwiZmluYWxseSIsInNldFRpbWVvdXQiLCJlbmFibGVWYWxpZGF0aW9uQ29uc3RhbnRzIiwicHJvZmlsZSIsInByb2ZpbGVFZGl0QnV0dG9uIiwicG9wdXBFZGl0IiwicG9wdXBDaGFuZ2UiLCJwb3B1cENoYW5nZUZvcm0iLCJhbGxQb3B1cCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwcm9maWxlQWRkQnV0dG9uIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJpbnB1dE5hbWUiLCJpbnB1dERlc2NyaXB0aW9uIiwiYXZhdGFyQ2hhbmdlQnRuIiwicG9wdXBBdmF0YXJDaGFuZ2UiLCJhdmF0YXJDaGFuZ2VJbnB1dCIsImNsb3NlQnV0dG9ucyIsImNvbnRhaW5lciIsInNlZW5JZHMiLCJTZXQiLCJmb3JFYWNoIiwiY2FyZCIsImhhcyIsInByZXBlbmQiLCJyZW5kZXJJbml0aWFsQ2FyZHMiLCJidXR0b24iLCJwb3B1cCIsImNvbnRhaW5zIiwiaW5uZXJUZXh0IiwicG9wdXBQcm9maWxlRWRpdEZvcm0iLCJhdmF0YXJMaW5rIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJmb3JtIiwiYnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUNsYXNzIiwiaW5wdXQiLCJpbnB1dHMiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsInJlbW92ZUF0dHJpYnV0ZSIsInRvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlIiwiaGlkZUlucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tJbnB1dFZhbGlkaXR5IiwiZXZlbnQiLCJzZXRFdmVudExpc3RlbmVycyJdLCJzb3VyY2VSb290IjoiIn0=